{% extends "base.html" %}

{% block content %}
<div class="row mb-4">
    <div class="col-md-8">
        <h2 class="fw-bold">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞</h2>
        <p class="text-muted">–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–≤–µ–¥–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ {{ transactions_count }} —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∑–∞ {{ dashboards['–ü–µ—Ä–∏–æ–¥ –∞–Ω–∞–ª–∏–∑–∞'] }}</p>
    </div>
    <div class="col-md-4 text-end">
        <a href="/" class="btn btn-outline-secondary"><i class="bi bi-arrow-counterclockwise"></i> –ù–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑</a>
    </div>
</div>

<!-- üëâ –ù–æ–≤—ã–π –±–ª–æ–∫: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–º–ø–∞–Ω–∏–∏ -->
{% if inn %}
<div class="card mb-4">
    <div class="card-header bg-white fw-bold">
        <i class="bi bi-building text-primary"></i> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–º–ø–∞–Ω–∏–∏
    </div>
    <div class="card-body">
        <div class="row g-3">

            <div class="col-md-4">
                <strong>–ò–ù–ù:</strong><br>
                <span class="text-primary">{{ inn }}</span>
            </div>

            <div class="col-md-4">
                <strong>–ù–∞–∑–≤–∞–Ω–∏–µ:</strong><br>
                <span>{{ company.name if company and company.name else "–ù–µ –Ω–∞–π–¥–µ–Ω–æ" }}</span>
            </div>

            <div class="col-md-4">
                <strong>–û–ì–†–ù:</strong><br>
                <span>{{ company.ogrn if company and company.ogrn else "–ù–µ –Ω–∞–π–¥–µ–Ω–æ" }}</span>
            </div>

            <div class="col-md-4">
                <strong>–°—Ç–∞—Ç—É—Å:</strong><br>
                <span class="badge bg-success" if company and company.status == "–î–µ–π—Å—Ç–≤—É—é—â–∞—è" else "badge bg-danger">
                    {{ company.status if company else "–ù–µ –Ω–∞–π–¥–µ–Ω–æ" }}
                </span>
            </div>

            <div class="col-md-4">
                <strong>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</strong><br>
                <span>{{ company.registration_date if company else "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö" }}</span>
            </div>

        </div>

        <!-- üëâ –°—Ç–æ–ø-—Ñ–∞–∫—Ç–æ—Ä—ã -->
        {% if stop_factors %}
        <div class="mt-4">
            <h6 class="fw-bold text-danger"><i class="bi bi-exclamation-triangle-fill"></i> –°—Ç–æ–ø-—Ñ–∞–∫—Ç–æ—Ä—ã:</h6>
            <ul class="text-danger">
                {% for sf in stop_factors %}
                <li>{{ sf }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
    </div>
</div>
{% endif %}
<!-- –ö–æ–Ω–µ—Ü –Ω–æ–≤–æ–≥–æ –±–ª–æ–∫–∞ -->

<div class="row mb-4">
    <div class="col-12">
        <div class="card text-white" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
            <div class="card-body p-4 d-flex justify-content-between align-items-center">
                <div>
                    <h5 class="text-white-50 text-uppercase ls-1">–ò—Ç–æ–≥–æ–≤—ã–π –±–∞–ª–ª Prescore</h5>
                    <h1 class="display-1 fw-bold mb-0">{{ scoringResults.total_score }}<span class="fs-4 text-white-50">/100</span></h1>
                </div>
                <div class="text-end">
                    <h3 class="mb-0">–†–∏—Å–∫: {{ scoringResults.risk_level }}</h3>
                    <span class="badge bg-light text-primary mt-2 p-2">–í—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ–¥–æ–±—Ä–µ–Ω–∏—è</span>
                </div>
            </div>
        </div>
    </div>
</div>

<h4 class="mb-3">–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</h4>
<div class="row g-3 mb-5">
    {% for key, value in dashboards.items() %}
    <div class="col-md-4 col-sm-6">
        <div class="card h-100">
            <div class="card-body text-center">
                <small class="text-muted text-uppercase">{{ key }}</small>
                <h3 class="fw-bold text-primary mt-2">{{ value }}</h3>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<div class="row">
    <div class="col-md-6 mb-4">
        <div class="card h-100">
            <div class="card-header bg-white fw-bold">–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–π—Ç–∏–Ω–≥–∞</div>
            <div class="card-body">
                <ul class="list-group list-group-flush">
                    {% for key, value in scoringResults.details.items() %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        {{ key }}
                        <span class="badge bg-primary rounded-pill">{{ value }}</span>
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <div class="col-md-6 mb-4">
        <div class="card h-100 border-warning" style="border-left: 5px solid #ffc107;">
            <div class="card-header bg-white fw-bold text-warning">
                <i class="bi bi-lightbulb-fill"></i> –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
            </div>
            <div class="card-body">
                <ul class="list-unstyled">
                    {% for rec in recommendations %}
                    <li class="mb-3 d-flex">
                        <i class="bi bi-check-circle-fill text-success me-2 mt-1"></i>
                        <span>{{ rec }}</span>
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}
